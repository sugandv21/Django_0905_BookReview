{% extends 'reviews/base.html' %}
{% block content %}
{% if user.is_authenticated %}
  <a class="btn btn-primary btn-sm mb-2" href="{% url 'reviews:review-add' book.pk %}">Add Review</a>
{% else %}
  <p><a href="{% url 'login' %}">Login</a> to add a review.</p>
{% endif %}

{% for review in book.reviews.all %}
  <div class="card mb-2">
    <div class="card-body">
      <h6>{{ review.user.username }} â€” {{ review.rating }}/5</h6>
      <p>{{ review.comment }}</p>
      <small>{{ review.created_at }}</small>

      {% if user.is_authenticated %}
        {% if user.is_staff or user == review.user %}
          <div class="mt-2">
            <a href="{% url 'reviews:review-edit' review.pk %}" class="btn btn-sm btn-secondary">Edit</a>
            <a href="{% url 'reviews:review-delete' review.pk %}" class="btn btn-sm btn-danger">Delete</a>
          </div>
        {% endif %}
      {% endif %}

    </div>
  </div>
{% empty %}
  <p>No reviews yet.</p>
{% endfor %}

{% endblock %}
